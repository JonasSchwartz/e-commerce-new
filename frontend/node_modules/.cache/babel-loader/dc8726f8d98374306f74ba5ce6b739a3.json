{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from\"axios\";import{useContext,useEffect,useReducer}from\"react\";import{Navigate,useParams}from\"react-router-dom\";import Row from\"react-bootstrap/Row\";import Col from\"react-bootstrap/Col\";import ListGroup from\"react-bootstrap/ListGroup\";import Rating from\"../components/Rating\";import Badge from\"react-bootstrap/Badge\";import Card from\"react-bootstrap/Card\";import Button from\"react-bootstrap/esm/Button\";import{Helmet}from\"react-helmet-async\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import{getError}from\"../utils\";import{Store}from\"../Store\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case\"FETCH_REQUEST\":return _objectSpread(_objectSpread({},state),{},{loading:true});case\"FETCH_SUCCESS\":return _objectSpread(_objectSpread({},state),{},{product:action.payload,loading:false});case\"FETCH_FAIL\":return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};function ProductScreen(){var params=useParams();var slug=params.slug;var _useReducer=useReducer(reducer,{product:[],loading:true,error:\"\"}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,product=_useReducer2$.product,dispatch=_useReducer2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:\"FETCH_REQUEST\"});_context.prev=1;_context.next=4;return axios.get(\"/api/products/slug/\".concat(slug));case 4:result=_context.sent;dispatch({type:\"FETCH_SUCCESS\",payload:result.data});_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](1);dispatch({type:\"FETCH_FAIL\",payload:getError(_context.t0)});case 11:case\"end\":return _context.stop();}}},_callee,null,[[1,8]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[slug]);var _useContext=useContext(Store),state=_useContext.state,ctxDispatch=_useContext.dispatch;var cart=state.cart;var addToCartHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var existItem,quantity,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:existItem=cart.cartItems.find(function(x){return x._id===product._id;});quantity=existItem?existItem.quantity+1:1;_context2.next=4;return axios.get(\"/api/products/\".concat(product._id));case 4:_yield$axios$get=_context2.sent;data=_yield$axios$get.data;if(!(data.countInStock<quantity)){_context2.next=9;break;}window.alert(\"Sorry, Product is out of stock\");return _context2.abrupt(\"return\");case 9:ctxDispatch({type:'CART_ADD_ITEM',payload:_objectSpread(_objectSpread({},product),{},{quantity:quantity})});case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function addToCartHandler(){return _ref2.apply(this,arguments);};}();return loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{md:6,children:/*#__PURE__*/_jsx(\"img\",{className:\"img-large\",src:product.image,alt:product.name})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsxs(ListGroup.Item,{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:product.name})}),/*#__PURE__*/_jsx(\"h1\",{children:product.name})]}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(Rating,{rating:product.rating,numReviews:product.numReviews})}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\" Pris : \",product.price,\" sek\"]}),/*#__PURE__*/_jsxs(ListGroup.Item,{children:[\" Beskrivning:\",/*#__PURE__*/_jsx(\"p\",{children:product.description})]})]})}),/*#__PURE__*/_jsx(Col,{md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Card.Body,{children:/*#__PURE__*/_jsxs(ListGroup,{variant:\"flush\",children:[/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"Pris:\"}),/*#__PURE__*/_jsxs(Col,{children:[product.price,\" sek\"]})]})}),/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(Col,{children:\"status:\"}),/*#__PURE__*/_jsxs(Col,{children:[product.countInStock>0?/*#__PURE__*/_jsxs(Badge,{bg:\"success\",children:[\" \",product.countInStock,\"st i lager\"]}):/*#__PURE__*/_jsx(Badge,{bg:\"danger\",children:\"Ej tillg\\xE4nglig\"}),\" \"]})]})}),product.countInStock>0&&/*#__PURE__*/_jsx(ListGroup.Item,{children:/*#__PURE__*/_jsx(\"div\",{className:\"d-grid\",children:/*#__PURE__*/_jsx(Button,{onClick:addToCartHandler,className:\"bg-dark border-none\",variant:\"primary\",children:\"L\\xE4gg till\"})})})]})})})})]})});}export default ProductScreen;","map":{"version":3,"names":["axios","useContext","useEffect","useReducer","Navigate","useParams","Row","Col","ListGroup","Rating","Badge","Card","Button","Helmet","LoadingBox","MessageBox","getError","Store","reducer","state","action","type","loading","product","payload","error","ProductScreen","params","slug","dispatch","fetchData","get","result","data","ctxDispatch","cart","addToCartHandler","existItem","cartItems","find","x","_id","quantity","countInStock","window","alert","image","name","rating","numReviews","price","description"],"sources":["C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/src/screens/ProductScreen.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useEffect, useReducer } from \"react\";\r\nimport {  Navigate, useParams } from \"react-router-dom\"\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Col from \"react-bootstrap/Col\";\r\nimport ListGroup from \"react-bootstrap/ListGroup\"\r\nimport Rating from \"../components/Rating\";\r\nimport Badge from \"react-bootstrap/Badge\"\r\nimport Card from \"react-bootstrap/Card\"\r\nimport Button from \"react-bootstrap/esm/Button\";\r\nimport { Helmet } from \"react-helmet-async\";\r\nimport LoadingBox from \"../components/LoadingBox\";\r\nimport MessageBox from \"../components/MessageBox\";\r\nimport { getError } from \"../utils\";\r\nimport { Store } from \"../Store\";\r\n\r\nconst reducer = (state,action) => {\r\n    switch(action.type) {\r\n        case `FETCH_REQUEST`:\r\n            return{...state,loading: true};\r\n         case `FETCH_SUCCESS`:\r\n            return  {...state,product:action.payload, loading: false};\r\n          case `FETCH_FAIL`:\r\n            return{...state,loading:false, error: action.payload};\r\n            default:   \r\n            return state;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction ProductScreen () {\r\n    \r\nconst params = useParams();\r\nconst  {slug} = params;\r\n\r\nconst [{loading, error,product}, dispatch] = useReducer(reducer, {\r\n    product:[],\r\n    loading: true,\r\n    error: ``,\r\n})\r\n\r\nuseEffect(() => {\r\nconst fetchData = async () => {\r\ndispatch({type: `FETCH_REQUEST`})\r\ntry {\r\nconst result = await axios.get(`/api/products/slug/${slug}`);\r\ndispatch({type:`FETCH_SUCCESS`, payload: result.data})\r\n} catch(err) {\r\n    dispatch({type: `FETCH_FAIL`, payload: getError(err)})\r\n    }   \r\n};\r\nfetchData();\r\n},[slug])\r\n\r\n\r\nconst {state, dispatch: ctxDispatch} = useContext(Store);\r\nconst {cart} = state;\r\nconst addToCartHandler = async () => {\r\n const existItem = cart.cartItems.find((x) =>x._id === product._id)\r\n const quantity = existItem ? existItem.quantity + 1 : 1\r\n const { data } = await axios.get(`/api/products/${product._id}`)\r\n\r\n\r\nif (data.countInStock < quantity) {\r\n    window.alert(\"Sorry, Product is out of stock\");\r\n    return;\r\n}\r\n\r\nctxDispatch({\r\n    type:'CART_ADD_ITEM',\r\n     payload: {...product, quantity}})\r\n}\r\n\r\n\r\n\r\n\r\nreturn loading? (\r\n    <LoadingBox/>\r\n) : error? (\r\n    <MessageBox variant=\"danger\">{error}</MessageBox>\r\n): (\r\n  <div>\r\n  <Row>\r\n    <Col md={6}>\r\n        <img\r\n         className=\"img-large\"\r\n        src={product.image}\r\n        alt={product.name}\r\n       ></img>\r\n    </Col>\r\n    \r\n    <Col md={3}>\r\n    <ListGroup variant=\"flush\">\r\n        <ListGroup.Item>\r\n           <Helmet>\r\n            <title>{product.name}</title>\r\n           </Helmet>\r\n                <h1>{product.name}</h1>\r\n\r\n           \r\n            \r\n        </ListGroup.Item>\r\n        <ListGroup.Item>\r\n            <Rating\r\n              rating={product.rating}\r\n              numReviews={product.numReviews}\r\n            ></Rating>\r\n        </ListGroup.Item>\r\n        <ListGroup.Item> Pris : {product.price} sek</ListGroup.Item>\r\n           \r\n        <ListGroup.Item> Beskrivning:\r\n            <p>{product.description}</p>\r\n        </ListGroup.Item>\r\n\r\n    </ListGroup>\r\n\r\n    </Col>\r\n    <Col md={3}>\r\n        <Card>\r\n            <Card.Body>\r\n            <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                    <Row>\r\n                        <Col>Pris:</Col>\r\n                        <Col>{product.price} sek</Col>\r\n                    </Row>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                    <Row>\r\n                        <Col>status:</Col>\r\n                        <Col>{product.countInStock>0?\r\n                        <Badge bg=\"success\"> {product.countInStock}st i lager</Badge>\r\n                            :\r\n                            <Badge bg=\"danger\">Ej tillgänglig</Badge>\r\n                    } </Col>\r\n                    </Row>\r\n                </ListGroup.Item>\r\n                        {product.countInStock > 0 && (\r\n                            <ListGroup.Item>\r\n                                <div className=\"d-grid\">\r\n                                    <Button onClick={addToCartHandler} className=\"bg-dark border-none\" variant=\"primary\">\r\n                                        Lägg till\r\n                                    </Button>\r\n                                </div>\r\n                            </ListGroup.Item>\r\n                        )}\r\n\r\n\r\n                </ListGroup>\r\n            </Card.Body>\r\n        </Card>\r\n    </Col>\r\n  </Row>\r\n  </div>\r\n  \r\n    \r\n)\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default ProductScreen"],"mappings":"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"},"metadata":{},"sourceType":"module"}