{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useContext,useEffect,useReducer}from'react';import{Helmet}from\"react-helmet-async\";import LoadingBox from\"../components/LoadingBox\";import MessageBox from\"../components/MessageBox\";import{Store}from'../Store';import{useNavigate}from'react-router-dom';import axios from'axios';import{getError}from'../utils';import Button from\"react-bootstrap/Button\";import Table from\"react-bootstrap/Table\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var reducer=function reducer(state,action){switch(action.type){case'FETCH_REQUEST':return _objectSpread(_objectSpread({},state),{},{loading:true});case'FETCH_SUCCESS':return _objectSpread(_objectSpread({},state),{},{orders:action.payload,loading:false});case'FETCH_FAIL':return _objectSpread(_objectSpread({},state),{},{loading:false,error:action.payload});default:return state;}};export default function OrderHistoryScreen(){var _useContext=useContext(Store),state=_useContext.state;var userInfo=state.userInfo;var navigate=useNavigate();var _useReducer=useReducer(reducer,{loading:true,error:''}),_useReducer2=_slicedToArray(_useReducer,2),_useReducer2$=_useReducer2[0],loading=_useReducer2$.loading,error=_useReducer2$.error,orders=_useReducer2$.orders,dispatch=_useReducer2[1];useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch({type:'FETCH_REQUEST'});_context.prev=1;_context.next=4;return axios.get(\"/api/orders/mine\",{headers:{Authorization:\"Bearer \".concat(userInfo.token)}});case 4:_yield$axios$get=_context.sent;data=_yield$axios$get.data;dispatch({type:'FETCH_SUCCESS',payload:data});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch({type:'FETCH_FAIL',payload:getError(_context.t0)});case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[userInfo]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:\"Orderhistorik\"})}),/*#__PURE__*/_jsx(\"h1\",{children:\"Orderhistorik\"}),loading?/*#__PURE__*/_jsx(LoadingBox,{}):error?/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error}):/*#__PURE__*/_jsxs(Table,{responsive:\"md\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Datum\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Summa\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Betald\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Levererad\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:orders.map(function(order){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:order._id}),/*#__PURE__*/_jsx(\"td\",{children:order.createdAt.substring(0,10)}),/*#__PURE__*/_jsx(\"td\",{children:order.totalPrice.toFixed(2)}),/*#__PURE__*/_jsx(\"td\",{children:order.isPaid?order.paidAt.substring(0,10):'Nej'}),/*#__PURE__*/_jsx(\"td\",{children:order.isDelivered?order.isDelivered.substring(0,10):'Nej'}),/*#__PURE__*/_jsx(\"td\",{responsive:\"md\",children:/*#__PURE__*/_jsx(Button,{type:\"Button\",variant:\"light\",onClick:function onClick(){navigate(\"/order/\".concat(order._id));},children:\"Detaljer\"})})]},order._id);})})]})]});}","map":{"version":3,"names":["React","useContext","useEffect","useReducer","Helmet","LoadingBox","MessageBox","Store","useNavigate","axios","getError","Button","Table","reducer","state","action","type","loading","orders","payload","error","OrderHistoryScreen","userInfo","navigate","dispatch","fetchData","get","headers","Authorization","token","data","map","order","_id","createdAt","substring","totalPrice","toFixed","isPaid","paidAt","isDelivered"],"sources":["C:/Users/jonas/OneDrive/Skrivbord/E-comm/frontend/src/screens/OrderHistoryScreen.js"],"sourcesContent":["import React, { useContext, useEffect, useReducer } from 'react'\r\nimport {Helmet} from \"react-helmet-async\"\r\nimport LoadingBox from \"../components/LoadingBox\"\r\nimport MessageBox from \"../components/MessageBox\"\r\nimport { Store } from '../Store'\r\nimport { useNavigate } from 'react-router-dom';\r\nimport axios from 'axios'\r\nimport { getError } from '../utils'\r\nimport Button from \"react-bootstrap/Button\"\r\nimport Table from \"react-bootstrap/Table\"\r\n\r\n\r\nconst reducer = (state,action) => {\r\n    switch (action.type) {\r\n        case 'FETCH_REQUEST':\r\n            return {...state,loading: true};\r\n            case 'FETCH_SUCCESS':\r\n                return {...state,orders: action.payload, loading: false};\r\n                case 'FETCH_FAIL':\r\n                    return{...state,loading: false,error:action.payload};\r\n                    default:\r\n                        return state;\r\n    }\r\n};\r\n\r\nexport default function OrderHistoryScreen() {\r\n    const {state} = useContext(Store);\r\n    const {userInfo} = state\r\n    const navigate = useNavigate();\r\n\r\n\r\nconst [{loading, error, orders}, dispatch] = useReducer(reducer,{\r\n    loading: true,\r\n    error:'',\r\n});\r\nuseEffect(() => {\r\nconst fetchData = async () => {\r\n    dispatch({type:'FETCH_REQUEST'});\r\n    try {\r\n        const {data} = await axios.get(\r\n            `/api/orders/mine`,\r\n            {headers: {Authorization: `Bearer ${userInfo.token}`}}\r\n        );\r\n        dispatch({type:'FETCH_SUCCESS', payload: data});\r\n    } catch (error){\r\n        dispatch({\r\n            type:'FETCH_FAIL',\r\n            payload:getError(error)\r\n        });\r\n    }\r\n};\r\nfetchData();\r\n}, [userInfo]);\r\n\r\n  return (\r\n    <div>\r\n    <Helmet>    \r\n    \r\n    <title>Orderhistorik</title>\r\n    </Helmet>\r\n\r\n    <h1>Orderhistorik</h1>\r\n\r\n{loading ? (\r\n        <LoadingBox></LoadingBox>\r\n    ) : error ?(\r\n        <MessageBox variant=\"danger\">{error}</MessageBox>\r\n    ): (\r\n\r\n        \r\n        <Table responsive=\"md\" >\r\n            \r\n            <thead>\r\n\r\n                <tr>\r\n            <th>ID</th>\r\n            <th>Datum</th>\r\n            <th>Summa</th>\r\n            <th>Betald</th>\r\n            <th>Levererad</th>\r\n            \r\n            </tr>\r\n            </thead>\r\n            <tbody >\r\n            \r\n                {orders.map((order)=>(\r\n                    <tr key={order._id}>\r\n                        <td>{order._id}</td>\r\n                        <td>{order.createdAt.substring(0,10)}</td>\r\n                        <td>{order.totalPrice.toFixed(2)}</td>\r\n                        <td>{order.isPaid ? order.paidAt.substring(0,10) : 'Nej'}</td>\r\n                        <td>{order.isDelivered ? order.isDelivered.substring(0,10): 'Nej'}\r\n                        </td>\r\n                        <td responsive=\"md\">\r\n                            <Button\r\n                                type='Button'\r\n                                variant=\"light\"\r\n                                onClick={() => {\r\n                                    navigate(`/order/${order._id}`)\r\n                                }}\r\n                            >\r\n                                Detaljer\r\n                            </Button>\r\n                        </td>\r\n                    </tr>\r\n                ))}\r\n            </tbody>\r\n        </Table>\r\n    )}\r\n  \r\n\r\n    </div>\r\n  ) \r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}